{
    "contents" : "---\ntitle: \"Analysis of Population Health and Economic Impacts of Severe Weather Events\"\nauthor: \"Nate LaClaire\"\ndate: \"October 8, 2016\"\noutput: \n  html_document:\n    keep_md: true\n---\n\nThis project involves analyzing NOAA (National Oceanic and Atmospheric Administration) [Storm Data](https://www.ncdc.noaa.gov/stormevents/) to determine the impact of severe weather events on local economies and population health. The goal of this analysis is to answer these two questions:\n\n1. Across the United States, which types of events are most harmful with respect to population health?\n2. Across the United States, which types of events have the greatest economic consequences?\n\nThe data provided covers 1950 through November 2011.\n\n# Data Processing\n\nBefore loading the data, it is appropriate to load the libraries that we will use during analysis and set some options for report production:\n\n```{r}\n# Load libraries\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(gridExtra)\nlibrary(grid)\nlibrary(RColorBrewer)\n\n# Set some options for knitr\nknitr::opts_chunk$set(tidy=FALSE, fig.path='figure/', out.height='500px')\n\n# Create a color palette for the graphs\nstormColors <- brewer.pal(6, \"Accent\")\n```\n\nThe data was provided in a compressed CSV file, which must be downloaded from the course-provided URL and then loaded into memory:\n\n```{r, cache=TRUE}\n# If the .csv.bz2 file doesn't exist, download it\nif (!file.exists(\"StormData.csv.bz2\")) {\n    download.file(\n        \"https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2\", \n        \"StormData.csv.bz2\")\n}\n\n# Load the data\nstormData <- read.csv(\"StormData.csv.bz2\", stringsAsFactors = FALSE)\n```\n\nThe data contains 37 variables:\n\n```{r}\ncolnames(stormData)\n```\n\nSince we will only utilize 7 of these variables in our analysis, we create a subset of the data:\n\n```{r}\nstormDataSub <- select(stormData, EVTYPE, FATALITIES, INJURIES, PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP)\n```\n\n## Preparing the population health values\n\nTo see the total impact on population health, we first summarize the data by type of event and then sum the numbers of fatalities and injuries:\n\n```{r}\n# Summarize by event type\npopHealth <- summarise(group_by(stormDataSub, EVTYPE), totalFatalities = sum(FATALITIES), totalInjuries = sum(INJURIES))\npopHealth$totalImpact <- popHealth$totalFatalities + popHealth$totalInjuries\n```\n\n## Preparing the economic impact values\n\nThe economic values are stored with exponential values in a separate column. Some of these values are numeric, but others are symbols or abbreviations. We create new columns of recoded values to use as the exponents:\n\n```{r}\n# Look at the original exponent values\nunique(stormDataSub$PROPDMGEXP)\nunique(stormDataSub$CROPDMGEXP)\n\n# Create new columns, filling them with numeric values from existing columns\nstormDataSub$PROPDMGEXP.B <- as.numeric(stormDataSub$PROPDMGEXP)\nstormDataSub$CROPDMGEXP.B <- as.numeric(stormDataSub$CROPDMGEXP)\n\n# Recode alphabetic characters as numbers and symbols as 0\nstormDataSub$PROPDMGEXP.B[stormDataSub$PROPDMGEXP %in% c('B','b')] <- 9\nstormDataSub$CROPDMGEXP.B[stormDataSub$CROPDMGEXP %in% c('B','b')] <- 9\nstormDataSub$PROPDMGEXP.B[stormDataSub$PROPDMGEXP %in% c('M','m')] <- 6\nstormDataSub$CROPDMGEXP.B[stormDataSub$CROPDMGEXP %in% c('M','m')] <- 6\nstormDataSub$PROPDMGEXP.B[stormDataSub$PROPDMGEXP %in% c('K','k')] <- 3\nstormDataSub$CROPDMGEXP.B[stormDataSub$CROPDMGEXP %in% c('K','k')] <- 3\nstormDataSub$PROPDMGEXP.B[stormDataSub$PROPDMGEXP %in% c('H','h')] <- 2\nstormDataSub$CROPDMGEXP.B[stormDataSub$CROPDMGEXP %in% c('H','h')] <- 2\nstormDataSub$PROPDMGEXP.B[stormDataSub$PROPDMGEXP %in% c(\"\", \"+\", \"-\", \"?\")] <- 0\nstormDataSub$CROPDMGEXP.B[stormDataSub$CROPDMGEXP %in% c(\"\", \"+\", \"-\", \"?\")] <- 0\n\n# Verify that only non-NULL numeric values are in the new columns\nunique(stormDataSub$PROPDMGEXP.B)\nunique(stormDataSub$CROPDMGEXP.B)\n```\n\nWe then do the math to yield new columns containing the actual values:\n\n```{r}\nstormDataSub$propertyDamage <- stormDataSub$PROPDMG * (10^stormDataSub$PROPDMGEXP.B)\nstormDataSub$cropDamage <- stormDataSub$CROPDMG * (10^stormDataSub$CROPDMGEXP.B)\n```\n\nNow that we have actual values, we summarize the data by the type of weather event:\n\n```{r}\neconImpact <- summarise(group_by(stormDataSub, EVTYPE), propertyDamage = sum(propertyDamage), cropDamage = sum(cropDamage))\n```\n\nFinally, we create a column to store the total economic impact:\n\n```{r}\neconImpact$economicImpact <- econImpact$propertyDamage + econImpact$cropDamage\n```\n\n# Results\n\n## Across the United States, which types of events are most harmful with respect to population health?\n\nTornadoes cause the most injuries and fatalities.\n\n```{r}\n# Figure 1, composed of 3 plots\nhealthPlot1 <- ggplot(data=head(popHealth[order(popHealth$totalFatalities, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, totalFatalities), y=totalFatalities)) +\n   geom_bar(fill=stormColors[1],stat=\"identity\")  + coord_flip() + \n    ylab(\"Total number of fatalities\") + xlab(\"Event type\") +\n    ggtitle(\"Storm impact in the US on population health - Top 10\") +\n    theme(legend.position=\"none\")\n\nhealthPlot2 <- ggplot(data=head(popHealth[order(popHealth$totalInjuries, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, totalInjuries), y=totalInjuries)) +\n    geom_bar(fill=stormColors[2],stat=\"identity\") + coord_flip() +\n    ylab(\"Total number of injuries\") + xlab(\"Event type\") +\n    theme(legend.position=\"none\")\n\nhealthPlot3 <- ggplot(data=head(popHealth[order(popHealth$totalImpact, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, totalImpact), y=totalImpact)) +\n    geom_bar(fill=stormColors[3],stat=\"identity\") + coord_flip() +\n    ylab(\"Total number of injuries + fatalities\") + xlab(\"Event type\") +\n    theme(legend.position=\"none\")\n\ngrid.arrange(healthPlot1, healthPlot2, healthPlot3, nrow = 3)\n```\n\n## Across the United States, which types of events have the greatest economic consequences?\n\nFloods have the highest total economic impact, followed by hurricanes/typhoons, tornadoes, storm surges, and hail. Interestingly, droughts cause the most crop damage.\n\n```{r}\n# Figure 2, composed of 3 plots\neconPlot1 <- ggplot(data=head(econImpact[order(econImpact$propertyDamage, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, propertyDamage), y=propertyDamage)) +\n   geom_bar(fill=stormColors[4],stat=\"identity\")  + coord_flip() + \n    ylab(\"Total amount of property damage, in dollars\") + xlab(\"Event type\") +\n    ggtitle(\"Storm impact in the US on local economies - Top 10\") +\n    theme(legend.position=\"none\")\n\neconPlot2 <- ggplot(data=head(econImpact[order(econImpact$cropDamage, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, cropDamage), y=cropDamage)) +\n    geom_bar(fill=stormColors[5],stat=\"identity\") + coord_flip() +\n    ylab(\"Total amount of crop damage, in dollars\") + xlab(\"Event type\") +\n    theme(legend.position=\"none\")\n\neconPlot3 <- ggplot(data=head(econImpact[order(econImpact$economicImpact, decreasing = TRUE),],10), aes(x=reorder(EVTYPE, economicImpact), y=economicImpact)) +\n    geom_bar(fill=stormColors[6],stat=\"identity\") + coord_flip() +\n    ylab(\"Total economic impact, in dollars\") + xlab(\"Event type\") +\n    theme(legend.position=\"none\")\n\ngrid.arrange(econPlot1, econPlot2, econPlot3, nrow = 3)\n```",
    "created" : 1475963117464.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2708134141",
    "id" : "6F6F5647",
    "lastKnownWriteTime" : 1475976866,
    "path" : "~/Documents/RepData/RepData_PeerAssessment2/StormDataAnalysis.Rmd",
    "project_path" : "StormDataAnalysis.Rmd",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}